require("ggplot2")
require("gridExtra")
require("reshape")
####################
#                  #
# weak competition #
#                  #
####################
smpl_wc1e3 = read.csv("/home/bb/Gits/branching.brownian.motion.and.spde/sample_path_wc1e3.csv")
#
# calculating strength of coevolution
#
x = smpl_wc1e3$x
G = smpl_wc1e3$G
N = smpl_wc1e3$N
w = 0.1
c = 1e-8
eta = 1.0
R = 1.0
a = 1e-2
th = 0
S = length(x)
b = matrix(0,nc=S,nr=S)
C = matrix(0,nc=S,nr=S)
alpha = matrix(0,nc=S,nr=S)
beta = matrix(0,nc=S,nr=S)
gamma = matrix(0,nc=S,nr=S)
for( i in 1:S){
for( j in 1:S ){
r = R - a*( (x[i]-th)^2 + G[i] + eta )/2
b[i,j] = 1/( G[i]+G[j]+2*(w+eta) )
alpha[i,j] = c*sqrt(b[i,j]/(2*pi))*exp(-b[i,j]*(x[i]-x[j])^2/2) / r
beta[i,j] = c*N[j]*b[i,j]*(x[i]-x[j])*sqrt(b[i,j]/(2*pi))*exp(-b[i,j]*(x[i]-x[j])^2/2)
gamma[i,j] = c*N[j]*b[i,j]*(1 - b[i,j]*(x[i]-x[j])^2)*sqrt(b[i,j]/(2*pi))*exp(-b[i,j]*(x[i]-x[j])^2/2)
C[i,j] = abs(beta[i,j]) + abs(gamma[i,j])
}
}
Cvec = NULL
for(i in 1:S){
for(j in i:S)
if( i!=j ) Cvec = c(Cvec,C[i,j])
}
avec = NULL
for(i in 1:S){
for(j in i:S)
if( i!=j ) avec = c(avec,alpha[i,j])
}
Cadf_WC = data.frame(Coev=Cvec,Comp=avec, Which="WC")
######################
#                    #
# strong competition #
#                    #
######################
smpl_mc1e3 = read.csv("/home/bb/Gits/branching.brownian.motion.and.spde/sample_path_mc1e3.csv")
#
# calculating strength of coevolution
#
x = smpl_mc1e3$x
G = smpl_mc1e3$G
N = smpl_mc1e3$N
w = 0.1
c = 5e-7
eta = 1.0
R = 1.0
a = 1e-2
th = 0
S = length(x)
b = matrix(0,nc=S,nr=S)
C = matrix(0,nc=S,nr=S)
alpha = matrix(0,nc=S,nr=S)
beta = matrix(0,nc=S,nr=S)
gamma = matrix(0,nc=S,nr=S)
for( i in 1:S){
for( j in 1:S ){
r = R - a*( (x[i]-th)^2 + G[i] + eta )/2
b[i,j] = 1/( G[i]+G[j]+2*(w+eta) )
alpha[i,j] = c*sqrt(b[i,j]/(2*pi))*exp(-b[i,j]*(x[i]-x[j])^2/2) / r
beta[i,j] = c*N[j]*b[i,j]*(x[i]-x[j])*sqrt(b[i,j]/(2*pi))*exp(-b[i,j]*(x[i]-x[j])^2/2)
gamma[i,j] = c*N[j]*b[i,j]*(1 - b[i,j]*(x[i]-x[j])^2)*sqrt(b[i,j]/(2*pi))*exp(-b[i,j]*(x[i]-x[j])^2/2)
C[i,j] = abs(beta[i,j]) + abs(gamma[i,j])
}
}
Cvec = NULL
for(i in 1:S){
for(j in i:S)
if( i!=j ) Cvec = c(Cvec,C[i,j])
}
avec = NULL
for(i in 1:S){
for(j in i:S)
if( i!=j ) avec = c(avec,alpha[i,j])
}
Cadf_SC = data.frame(Coev=Cvec,Comp=avec, Which="SC")
# bivariate plot
Cadf = rbind(Cadf_WC,Cadf_SC)
head(Cadf)
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-6,1e-2)) +
scale_y_log10(limits=c(1e-10,2e-7)) +
geom_density_2d(col="black",n=200) +
geom_density_2d(data=Cadf_SC,col="red",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
# on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) + geom_bin2d(bins=100,alpha=0.4) +
#   geom_bin2d(data=Cadf_SC,alpha=0.4,bins=100) +
#   scale_x_log10(limits=c(1e-6,1e-2)) + scale_y_log10(limits=c(1e-10,2e-7)) +
#   theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(2e-5,5e-4)) +
scale_y_log10(limits=c(2e-9,1e-7)) +
geom_density_2d(col="black",n=200) +
geom_density_2d(data=Cadf_SC,col="red",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(2e-5,2e-4)) +
scale_y_log10(limits=c(5e-9,1e-7)) +
geom_density_2d(col="black",n=200) +
geom_density_2d(data=Cadf_SC,col="red",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(2e-5,2e-4)) +
scale_y_log10(limits=c(1e-10,6e-8)) +
geom_density_2d(col="black",n=200) +
geom_density_2d(data=Cadf_SC,col="red",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(2e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,col="red") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(3e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,col="red") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(5e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(7e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed",col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-6,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed",col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(5e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed",col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(5e-6,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed",col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(2e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed",col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
geom_density_2d(data=Cadf_SC,linetype="dashed",col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
install.packages("gg.gap")
require(gg.gap)
gg.gap(on_pl,ylim=c(5e-10,6e-8),segments=list(c(5e-10,1e-9),c(2e-8,6e-8)))
gg.gap(on_pl,ylim=c(5e-10,6e-8),segments=list(c(5.5e-10,1e-9),c(2e-8,6e-8)))
gg.gap(on_pl,ylim=c(5e-10,6e-8),segments=c(1e-9,2e-8))
gg.gap(on_pl,ylim=c(1e-10,6e-8),segments=c(2e-9,1e-8))
gg.gap(on_pl,ylim=c(5e-11,6e-8),segments=c(2e-9,1e-8))
gg.gap(on_pl,ylim=c(5e-11,6e-8),segments=list(c(2e-9,1e-8)))
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(1e-10,1e-9)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(5e-10,8e-10)) +
geom_density_2d(linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7e-10,8e-10)) +
geom_density_2d(linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
SCpl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(1e-9,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
SCpl
SCpl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(2e-8,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
SCpl
SCpl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(2e-8,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("") + ylab("Competition Coefficient") + theme(axis.ticks.x=element_blank())
SCpl
SCpl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(2e-8,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("") + ylab("Competition Coefficient") + theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
SCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7e-10,8e-10)) +
geom_density_2d(linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
grid.arrange(SCpl,WCpl,nrow=2)
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(1e-10,1e-9)) +
geom_density_2d(linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(1e-10,5e-9)) +
geom_density_2d(linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7e-10,8e-10)) +
geom_density_2d(linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7e-10,8e-10)) +
geom_density_2d(linetype="dashed", col="black",n=100) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7e-10,8e-10)) +
geom_density_2d(linetype="dashed", col="black",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7.3e-10,7.75e-10)) +
geom_density_2d(linetype="dashed", col="black",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("Competition Coefficient")
WCpl
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7.3e-10,7.75e-10)) +
geom_density_2d(linetype="dashed", col="black",n=200) +
theme_minimal() + xlab("Pairwise Coevolution")
SCpl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(2e-8,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("") + theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
grid.arrange(SCpl,WCpl,nrow=2) + ylab("Competition Coefficient")
WCpl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7.3e-10,7.75e-10)) +
geom_density_2d(linetype="dashed", col="black",n=200) +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("")
SCpl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(2e-8,6e-8)) +
geom_density_2d(col="black") +
theme_minimal() + xlab("") + ylab("") + theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
on_pl = grid.arrange(SCpl,WCpl,nrow=2)
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
head(Cadf)
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
scale_y_log10(limits=c(7.3e-10,6e-8)) +
geom_density_2d(linetype="dashed", col="black",n=200) +
geom_density_2d(data=Cadf_SC,col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("")
on_pl
on_pl + facet_grid(rows = vars(Which))
on_pl = ggplot(Cadf_WC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
geom_density_2d(linetype="dashed", col="black",n=200) +
geom_density_2d(data=Cadf_SC,col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("")
on_pl + facet_grid(rows = vars(Which))
on_pl + facet_grid(rows = vars(Which),scales="free_y")
on_pl = ggplot(Cadf_SC, aes(Coev,Comp)) +
scale_x_log10(limits=c(1e-5,2e-4)) +
geom_density_2d(col="black",n=200) +
geom_density_2d(data=Cadf_WC, linetype="dashed", col="black") +
theme_minimal() + xlab("Pairwise Coevolution") + ylab("")
on_pl + facet_grid(rows = vars(Which),scales="free_y")
on_pl + facet_grid(rows = vars(Which),scales="free_y") + ylab("Competition Coefficient")
on_pl + facet_grid(rows=vars(Which), scales="free_y", labeller="") + ylab("Competition Coefficient")
on_pl + facet_grid(rows=vars(Which), scales="free_y", labeller="") + ylab("Competition Coefficient") + theme(strip.background = element_blank(), strip.text.y = element_blank())
on_pl + facet_grid(rows=vars(Which), scales="free_y") +
ylab("Competition Coefficient") + theme(strip.background = element_blank(), strip.text.y = element_blank())
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl,device="png",width=3.5,height=3.5,units="in")
on_pl2 = on_pl + facet_grid(rows=vars(Which), scales="free_y") +
ylab("Competition Coefficient") + theme(strip.background = element_blank(), strip.text.y = element_blank())
ggsave("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/on_pl.png",on_pl2,device="png",width=3.5,height=3.5,units="in")
knitr::opts_chunk$set(fig.pos = "!H", out.extra = "")
Set
\begin{equation}
\Phi(x,t)=\frac{\exp\left(-x^2/2\mu t\right)}{\sqrt{2\pi\mu t}}.
\end{equation}
Then the semigroup $\{S(t)\}_{t\geq0}$ given by
\begin{equation}
S(t)v=\int_0^t\frac{\mu}{2}\Delta\nu(x,s)ds=\int_\mathbb{R}\Phi(x-y,t)v(y)dy, \ \ \forall \ \ t>0, \ v\in L^\infty(\mathbb{R})
\end{equation}
and $S(0)v:=v$ satisfies $\|S(t)v\|_1=\|v\|_1$ for all $t\geq0$ and $v\in L^1(\mathbb{R})$. We also define the operator
\begin{equation}
(Fv)(x)=m\left(\int_\mathbb{R}\kappa(x,y)v(y)dy,x\right)v(x), \ \ \forall \ \ v\in L^1(\mathbb{R}).
\end{equation}
Thus $\|Fv\|_1\leq |r| \ \|v\|_1$ for all $v\in L^1(\mathbb{R})$. Now, for some $T>0$ set $$ functions $\nu:[0,T]\to L^1(\mathbb{R})$, and consider the operator defined on $L^1([0,T]\times{R})$ by
\begin{equation}
G\nu=S(t)\nu(0)+\int_0^tS(t-s)(F\nu(s))ds \ \ \forall \ \ t\in[0,T].
\end{equation}
setwd("~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology")
tinytex::pdflatex("draft.Rmd")
install.packages("rmarkdown")
install.packages("rmarkdown")
knit_with_parameters('~/Gits/branching.brownian.motion.and.spde/.A White Noise Approach To Evolutionary Ecology/draft.Rmd')
tinytex::pdflatex("draft.tex")
